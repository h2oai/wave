(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{168:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return u}));var n=a(2),r=a(6),i=(a(0),a(313)),o=(a(315),{slug:"ml-release-0.3.0",title:"Introducing Wave ML - AutoML for Wave Apps",author:"Peter Szab\xf3",author_title:"Lead Software Engineer @ H2O.ai",author_url:"https://github.com/geomodular",author_image_url:"https://www.gravatar.com/avatar/17c05e511a981a1f0b35eb8d4648947c",tags:["release"]}),l={permalink:"/wave/blog/ml-release-0.3.0",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-03-08-ml-release.md",source:"@site/blog/2021-03-08-ml-release.md",description:"Today, we're excited to announce H2O Wave ML, an open-source automatic machine learning package for Wave apps. In this article, we look at what Wave ML can do for you, how to get started, and what predictive applications look like in practice.",date:"2021-03-08T00:00:00.000Z",tags:[{label:"release",permalink:"/wave/blog/tags/release"}],title:"Introducing Wave ML - AutoML for Wave Apps",readingTime:5.82,truncated:!0,nextItem:{title:"Routing, Themes and Analytics",permalink:"/wave/blog/release-0.12.1"}},c=[{value:"Introduction",id:"introduction",children:[]},{value:"Why Wave ML?",id:"why-wave-ml",children:[]},{value:"Installation",id:"installation",children:[]},{value:"API Overview",id:"api-overview",children:[]},{value:"Predicting Wine Ratings",id:"predicting-wine-ratings",children:[{value:"Train the model",id:"train-the-model",children:[]},{value:"Build the UI",id:"build-the-ui",children:[]},{value:"Compute and show predictions",id:"compute-and-show-predictions",children:[]}]},{value:"Another Example",id:"another-example",children:[]},{value:"Conclusion",id:"conclusion",children:[]}],p={rightToc:c};function u(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},p,o,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Today, we're excited to announce H2O Wave ML, an open-source automatic machine learning package for Wave apps. In this article, we look at what Wave ML can do for you, how to get started, and what predictive applications look like in practice."),Object(i.b)("h2",{id:"introduction"},"Introduction"),Object(i.b)("p",null,"H2O Wave ML makes it quick and easy to build and integrate predictive (AI/ML) models into your Wave apps.  It provides a simple, high-level API for training, deploying, scoring and explaining machine learning models, letting you rapidly build and deploy  interactive predictive and decision-support applications over the web."),Object(i.b)("p",null,"Wave ML uses the open-source ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.h2o.ai/products/h2o/"}),"H2O AutoML")," under the hood, and is designed to (optionally) transparently switch over to ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.h2o.ai/products/h2o-driverless-ai/"}),"Driverless AI")," when deployed on ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.h2o.ai/hybrid-cloud/"}),"H2O.ai Hybrid Cloud"),"."),Object(i.b)("p",null,Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave"}),"Wave"),", ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml"}),"Wave ML")," and ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/h2o-3"}),"H2O AutoML")," are all 100% open source under Apache v2, so you can build and deploy predictive apps on your own, in your preferred deployment environment. "),Object(i.b)("h2",{id:"why-wave-ml"},"Why Wave ML?"),Object(i.b)("p",null,"Even as the number of data scientists worldwide is increasing by leaps and bounds, there are even more developers who are building applications for various business needs. There are anywhere from 7M to 23M Python developers in the world currently, of which many are not proficient with data science. With H2O Wave ML, we abstract away the complexity of machine learning and empower developers to solve business needs in their applications with the power of AutoML."),Object(i.b)("h2",{id:"installation"},"Installation"),Object(i.b)("p",null,Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://pypi.org/project/h2o-wave-ml/"}),"H2O Wave ML")," is a companion Python package to ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://pypi.org/project/h2o-wave/"}),"H2O Wave")," (both available on PyPI). Both Wave and Wave ML can be installed in tandem using ",Object(i.b)("inlineCode",{parentName:"p"},"pip"),": "),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell"}),"(venv) $ pip install h2o-wave[ml]\n")),Object(i.b)("p",null,"To use the package, simply import ",Object(i.b)("inlineCode",{parentName:"p"},"h2o_wave_ml"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py"}),"import h2o_wave_ml\n")),Object(i.b)("h2",{id:"api-overview"},"API Overview"),Object(i.b)("p",null,"Wave ML provides four high-level functions:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"build_model()"),": Train a model on a dataset, given the column to be predicted."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"Model.predict()"),": Make a prediction."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"save_model()"),": Save your model."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"load_model()"),": Load your previously saved model.")),Object(i.b)("p",null,"Use ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml#build_model"}),Object(i.b)("inlineCode",{parentName:"a"},"build_model()"))," to train a model. The function accepts a dataset and a ",Object(i.b)("em",{parentName:"p"},"target column")," (the column to be predicted):"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{3}","{3}":!0}),"from h2o_wave_ml import build_model\n\nmodel = build_model('./train.csv', target_column='depth')\n")),Object(i.b)("p",null,"The call to ",Object(i.b)("inlineCode",{parentName:"p"},"build_model()")," automatically determines if the prediction task is ",Object(i.b)("em",{parentName:"p"},"classification")," (predict a category or class) or ",Object(i.b)("em",{parentName:"p"},"regression")," (predict a real value, often a quantity)."),Object(i.b)("p",null,"Once the model is built, we can get the model's predictions using its ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml#modelpredict"}),Object(i.b)("inlineCode",{parentName:"a"},"predict()"))," method:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{4}","{4}":!0}),"from h2o_wave_ml import build_model\n\nmodel = build_model('./train.csv', target_column='depth')\npredictions = model.predict(file_path='./test.csv')\n")),Object(i.b)("p",null,"You can aso get the model's predictions by directly passing in the test rows:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{2-4}","{2-4}":!0}),"predictions = model.predict([\n    ['width', 'height'], \n    [width1, height1], \n    [width2, height2], \n    ...\n])\n")),Object(i.b)("p",null,"To save this model locally, use ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml#save_model"}),Object(i.b)("inlineCode",{parentName:"a"},"save_model()")),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{4}","{4}":!0}),"from h2o_wave_ml import build_model, save_model\n\nmodel = build_model('./train.csv', target_column='depth')\nmodel_path = save_model(model, output_dir_path='./')\n")),Object(i.b)("p",null,"To load a saved model, use ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml#load_model"}),Object(i.b)("inlineCode",{parentName:"a"},"load_model()")),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{1}","{1}":!0}),"model = load_model(model_path)\npredictions = model.predict(file_path='./test.csv')\n")),Object(i.b)("p",null,"See ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml#api"}),"API")," for more information. "),Object(i.b)("h2",{id:"predicting-wine-ratings"},"Predicting Wine Ratings"),Object(i.b)("p",null,"Let's build a simple web app for predicting wine ratings. The app will prompt for the wine's features, and display the predicted rating."),Object(i.b)("p",null,Object(i.b)("img",{alt:"demo",src:a(570).default})),Object(i.b)("h3",{id:"train-the-model"},"Train the model"),Object(i.b)("p",null,"We use the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.kaggle.com/christopheiv/winemagdata130k"}),"Kaggle wine dataset")," with just the ",Object(i.b)("inlineCode",{parentName:"p"},"country"),", ",Object(i.b)("inlineCode",{parentName:"p"},"points"),", ",Object(i.b)("inlineCode",{parentName:"p"},"price"),", ",Object(i.b)("inlineCode",{parentName:"p"},"province"),", ",Object(i.b)("inlineCode",{parentName:"p"},"region_1"),", ",Object(i.b)("inlineCode",{parentName:"p"},"variety")," and ",Object(i.b)("inlineCode",{parentName:"p"},"winery")," columns. The preprocessing steps can be found ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml/blob/main/examples/wine.py"}),"here"),"."),Object(i.b)("p",null,"First, we train the model to predict the ",Object(i.b)("inlineCode",{parentName:"p"},"points")," (ratings) column."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{3}","{3}":!0}),"from h2o_wave_ml import build_model\n\nmodel = build_model('./winemag_edit.csv', target_column='points')\n")),Object(i.b)("h3",{id:"build-the-ui"},"Build the UI"),Object(i.b)("p",null,"Next, we build a user interface that prompts the user for a wine's features. We'll use dropdowns to prompt for the all of wine's features, except for the ",Object(i.b)("inlineCode",{parentName:"p"},"price"),", which we'll display as a slider."),Object(i.b)("p",null,"To display unique values in the UI's dropdowns, load up the dataset in ",Object(i.b)("inlineCode",{parentName:"p"},"datatable"),", then use ",Object(i.b)("inlineCode",{parentName:"p"},"unique()")," to compute the unique values in each column."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{6}","{6}":!0}),"import datatable as dt\n\ndf = dt.fread('./winemag_edit.csv')\n\nfeatures = ['country', 'price', 'province', 'region_1', 'variety', 'winery']\ncolumns = {f: dt.unique(df[f]).to_list()[0] for f in features}\n")),Object(i.b)("p",null,"Next, use Wave's ",Object(i.b)("inlineCode",{parentName:"p"},"ui.choice()")," function to build up dropdown choices from the unique values:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{1}","{1}":!0}),"choices = {key: [ui.choice(str(item)) for item in columns[key] if item] for key in columns}\n")),Object(i.b)("p",null,"Finally, we display all the inputs in a form: "),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py"}),"q.page['wine'] = ui.form_card(box='body', items=[\n    ui.dropdown(name='country', label='Country', value=country, trigger=True, choices=choices['country']),\n    ui.dropdown(name='province', label='Province', value=province, trigger=True, choices=choices['province']),\n    ui.dropdown(name='region', label='Region', value=region, trigger=True, choices=choices['region_1']),\n    ui.dropdown(name='variety', label='Variety', value=variety, trigger=True, choices=choices['variety']),\n    ui.dropdown(name='winery', label='Winery', value=winery, trigger=True, choices=choices['winery']),\n    ui.slider(name='price', label='Price in $', min=4, max=150, step=1, value=price, trigger=True),\n])\n")),Object(i.b)("h3",{id:"compute-and-show-predictions"},"Compute and show predictions"),Object(i.b)("p",null,"To compute the wine's rating, we read all the inputs from ",Object(i.b)("inlineCode",{parentName:"p"},"q.args")," and call ",Object(i.b)("inlineCode",{parentName:"p"},"predict()")," on our model:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{11}","{11}":!0}),"@app('/demo')\nasync def serve(q: Q):\n    country = q.args.country or default_value['country']\n    price = float(q.args.price) if q.args.price else default_value['price']\n    province = q.args.province or default_value['province']\n    region = q.args.region or default_value['region_1']\n    variety = q.args.variety or default_value['variety']\n    winery = q.args.winery or default_value['winery']\n\n    input_data = [features, [country, price, province, region, variety, winery]]\n    rating = model.predict(input_data)\n    rating = rating[0][0]\n")),Object(i.b)("p",null,"Finally, we use a stat card from the Wave component library to display the predicted wine rating:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py",metastring:"{4}","{4}":!0}),"q.page['result'] = ui.tall_gauge_stat_card(\n    box=ui.box('body', height='180px'),\n    title='',\n    value=str(rating),\n    aux_value='points',\n    plot_color='$red' if rating < 90 else '$green',\n    progress=rating/100,\n)\n")),Object(i.b)("p",null,"See the full example ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml/blob/main/examples/wine.py"}),"here"),"."),Object(i.b)("h2",{id:"another-example"},"Another Example"),Object(i.b)("p",null,"Here's another example that displays variations in ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Confusion_matrix"}),"confusion matrices")," for a model built on the popular Titanic dataset."),Object(i.b)("p",null,Object(i.b)("img",{alt:"confusion matrix",src:a(571).default})),Object(i.b)("p",null,"Here's the complete example (~25 lines of code!):"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-py"}),"import datatable as dt\nfrom h2o_wave import main, app, Q, ui\nfrom h2o_wave_ml import build_model, save_model, load_model\nfrom sklearn.metrics import confusion_matrix\n\ndataset = './titanic.csv'\ntarget_column = 'Survived'\n\nmodel = build_model(dataset, target_column=target_column)\nprediction = model.predict(file_path=dataset)\n\n# Prepare the actual values from target_column\ndf = dt.fread(dataset)\ny_true = df[target_column].to_list()[0]\n\ntemplate = '''\n## Confusion Matrix for Titanic\n|              |           |              |\n| :-:          |:-:        |:-:           |\n|              | Survived  | Not survived |\n| Survived     | **{tp}**  | {fp} (FP)    |\n| Not survived | {fn} (FN) | **{tn}**     |\n'''\n\n@app('/demo')\nasync def serve(q: Q):\n\n    # Get a threshold value if available or 0.5 by default\n    threshold = q.args.slider if 'slider' in q.args else 0.5\n\n    # Compute confusion matrix\n    y_pred = [p[1] < threshold for p in prediction]\n    tn, fp, fn, tp = confusion_matrix(y_true, y_pred).ravel()\n\n    # Handle interaction\n    if not q.client.initialized:  # First visit, create a card for the matrix\n        q.page['matrix'] = ui.form_card(box='1 1 3 4', items=[\n            ui.text(template.format(tn=tn, fp=fp, fn=fn, tp=tp)),\n            ui.slider(name='slider', label='Threshold', min=0, max=1, step=0.01, value=0.5, trigger=True),\n        ])\n        q.client.initialized = True\n    else:\n        q.page['matrix'].items[0].text.content = template.format(tn=tn, fp=fp, fn=fn, tp=tp)\n        q.page['matrix'].items[1].slider.value = threshold\n\n    await q.page.save()\n")),Object(i.b)("p",null,Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml/blob/main/examples/quickstart.py"}),"Source"),"."),Object(i.b)("h2",{id:"conclusion"},"Conclusion"),Object(i.b)("p",null,"With just a couple of lines of code, you can now harness the power of the H2O platform and integrate predictive models into your Wave apps. In an upcoming release, we'll be automating this even further, letting you code-generate complete, interactive apps like the examples above with a single command. Stay tuned!"),Object(i.b)("p",null,"Follow updates to Wave ML on Github: ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/h2oai/wave-ml"}),"https://github.com/h2oai/wave-ml"),". Let us know what you think, and how we can improve it."),Object(i.b)("p",null,"We look forward to continuing our collaboration with the community and hearing your feedback as we further improve and expand the H2O Wave platform."))}u.isMDXComponent=!0},313:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=r.a.createContext({}),u=function(e){var t=r.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=u(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=u(a),b=n,m=d["".concat(o,".").concat(b)]||d[b]||s[b]||i;return a?r.a.createElement(m,l(l({ref:t},p),{},{components:a})):r.a.createElement(m,l({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}b.displayName="MDXCreateElement"},314:function(e,t,a){"use strict";var n=a(0),r=a(19);t.a=function(){var e=Object(n.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},315:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(314),r=a(316);function i(){var e=Object(n.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var i=void 0===n?{}:n,o=i.forcePrependBaseUrl,l=void 0!==o&&o,c=i.absolute,p=void 0!==c&&c;if(!a)return a;if(a.startsWith("#"))return a;if(Object(r.b)(a))return a;if(l)return t+a;var u=a.startsWith(t)?a:t+a.replace(/^\//,"");return p?e+u:u}(i,a,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},316:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}))},570:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/wine-0397eafc72ef7e2cb00f21693c163189.gif"},571:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/cm-7ad2d3235b3efbc7d94bbd15893e3d41.gif"}}]);